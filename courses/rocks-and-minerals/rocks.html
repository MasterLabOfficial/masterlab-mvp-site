<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rocks & Minerals â€” MasterLab Course</title>

    <!-- MasterLab Global Styles -->
    <link rel="stylesheet" href="/masterlab-mvp-site/css/global.css">
    <link rel="stylesheet" href="/masterlab-mvp-site/css/course-map.css">

    <!-- R&M Styles -->
    <link rel="stylesheet" href="rm-style.css">

    <!-- Lock Logic -->
    <script src="rm-lock.js"></script>

    <style>
        /* Lock indicator styling */
        .lock-status {
            font-size: 0.9rem;
            font-weight: bold;
        }
        .unlocked {
            color: #00FFA7; /* Joshua Glow */
        }
        .locked {
            color: #ff4d4d;
        }
        .lesson-card.disabled {
            pointer-events: none;
            opacity: 0.5;
        }

        .lesson-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>

<body>

    <div class="course-container">
        <h1 class="course-title">Rocks & Minerals (Division C)</h1>
        <p class="course-subtitle">MasterLab Science Olympiad Prep</p>

        <div class="lesson-grid">

            <!-- LESSON 1 -->
            <a class="lesson-card" href="Lessons/rm-lesson1.html" data-lesson="1">
                <div class="lesson-header">
                    <h2>Lesson 1</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>What Is a Mineral?</p>
            </a>

            <!-- LESSON 2 -->
            <a class="lesson-card" href="Lessons/rm-lesson2.html" data-lesson="2">
                <div class="lesson-header">
                    <h2>Lesson 2</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Mineral Criteria & Nonâ€‘Examples</p>
            </a>

            <!-- LESSON 3 -->
            <a class="lesson-card" href="Lessons/rm-lesson3.html" data-lesson="3">
                <div class="lesson-header">
                    <h2>Lesson 3</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Mineral Properties</p>
            </a>

            <!-- LESSON 4 -->
            <a class="lesson-card" href="Lessons/rm-lesson4.html" data-lesson="4">
                <div class="lesson-header">
                    <h2>Lesson 4</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Mineral ID Strategy</p>
            </a>

            <!-- LESSON 5 -->
            <a class="lesson-card" href="Lessons/rm-lesson5.html" data-lesson="5">
                <div class="lesson-header">
                    <h2>Lesson 5</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Mineral Groups</p>
            </a>

            <!-- LESSON 6 -->
            <a class="lesson-card" href="Lessons/rm-lesson6.html" data-lesson="6">
                <div class="lesson-header">
                    <h2>Lesson 6</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Igneous Rocks</p>
            </a>

            <!-- LESSON 7 -->
            <a class="lesson-card" href="Lessons/rm-lesson7.html" data-lesson="7">
                <div class="lesson-header">
                    <h2>Lesson 7</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Sedimentary Rocks</p>
            </a>

            <!-- LESSON 8 -->
            <a class="lesson-card" href="Lessons/rm-lesson8.html" data-lesson="8">
                <div class="lesson-header">
                    <h2>Lesson 8</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Metamorphic Rocks</p>
            </a>

            <!-- LESSON 9 -->
            <a class="lesson-card" href="Lessons/rm-lesson9.html" data-lesson="9">
                <div class="lesson-header">
                    <h2>Lesson 9</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Rock Cycle & Processes</p>
            </a>

            <!-- LESSON 10 -->
            <a class="lesson-card" href="Lessons/rm-lesson10.html" data-lesson="10">
                <div class="lesson-header">
                    <h2>Lesson 10</h2>
                    <span class="lock-status">Loading...</span>
                </div>
                <p>Competition Strategy & Official Sheet</p>
            </a>

        </div>

        <p class="footer-note">
            Lessons unlock based on date and test completion.  
            Regionals: <strong>February 14</strong>
        </p>
    </div>

    <!-- Lock Indicator Script -->
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const cards = document.querySelectorAll(".lesson-card");

        cards.forEach(card => {
            const lesson = parseInt(card.dataset.lesson);
            const statusEl = card.querySelector(".lock-status");

            const dayUnlocked = isDayUnlocked(lesson);
            const testUnlocked = isTestComplete(lesson);

            if (dayUnlocked && testUnlocked) {
                statusEl.textContent = "ðŸ”“ Unlocked";
                statusEl.classList.add("unlocked");
            } 
            else if (!dayUnlocked) {
                statusEl.textContent = "ðŸ”’ Locked (Date)";
                statusEl.classList.add("locked");
                card.classList.add("disabled");
                card.href = "#";
            }
            else if (!testUnlocked) {
                statusEl.textContent = "ðŸ”’ Locked (Test)";
                statusEl.classList.add("locked");
                card.classList.add("disabled");
                card.href = "#";
            }
        });
    });
    </script>

    <p id="xp-display" style="margin-top: 20px; font-size: 1.1rem; opacity: 0.8;">
        XP: Loading...
    </p>

    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const xp = localStorage.getItem("ml_xp") || "0";
        document.getElementById("xp-display").textContent = `XP: ${xp}`;
    });
    </script>

</body>
</html>
